'From Squeak5.1 of 15 October 2017 [latest update: #16550] on 26 October 2017 at 4:24:58 pm'!Object subclass: #DrinklistMailclient	instanceVariableNames: ''	classVariableNames: ''	poolDictionaries: ''	category: 'Drinklist'!!DrinklistMailclient methodsFor: 'as yet unclassified' stamp: 'jb 10/26/2017 12:10'!emailHost	^ #[127 0 0 1].! !!DrinklistMailclient methodsFor: 'as yet unclassified' stamp: 'jb 10/26/2017 12:10'!emailPort	^ 1111.! !!DrinklistMailclient methodsFor: 'as yet unclassified' stamp: 'jb 10/26/2017 12:11'!emailUser ^ 'tobias.zagorni'.! !!DrinklistMailclient methodsFor: 'as yet unclassified' stamp: 'jb 10/26/2017 15:41'!encode: aText ^ '=?utf-8?B?', aText squeakToUtf8 base64Encoded, '?='! !!DrinklistMailclient methodsFor: 'as yet unclassified' stamp: 'jb 10/26/2017 16:15'!sendEmailTo: anEmailAddress withText: text withSubject: subject""self sendEmailTo: anEmailAddress  withText: text withSubject: subject andType: 'text/plain'.! !!DrinklistMailclient methodsFor: 'as yet unclassified' stamp: 'jb 10/26/2017 16:15'!sendEmailTo: anEmailAddress withText: text withSubject: subject andType: anEmailType""| smtpClient |smtpClient := SMTPClient openOnHost: self emailHost port: self emailPort.smtpClient user: 'tobias.zagorni'.smtpClient password: 'A35gs77'.smtpClient login.smtpClient mailFrom: 'tobias.zagorni@student.hpi.de' to: { anEmailAddress } text: 'From: ', (self encode: 'Getränkekühlschrank'), '<tobias.zagorni@student.hpi.de>','To: ', anEmailAddress, 'Subject: ' , (self encode: subject) , 'Content-Transfer-Encoding: 8bitContent-Type: ', anEmailType   , '; charset=urf-8' , (text squeakToUtf8).smtpClient quit.! !!DrinklistMailclient methodsFor: 'as yet unclassified' stamp: 'jb 10/26/2017 16:24'!sendOrderMailTo: adminAddress withStock: stockList|text|text := 'Lieber Getränke-Gott,<br><br>es ist wieder soweit!! Du darfst bestellen!!!!!!<br><br>Hier eine hübsche Übersicht mit den Getränken:<br><br><table border="1"><tr><th>Getränk</th><th>verbliebene Anzahl</th>'.stockList do: [ :drink |  text := text, '<tr><td>',(drink key),'</td><td>',(drink value),'</td></tr>'.].text := text, '</table>'.self sendEmailTo: adminAddress withText: text withSubject: 'Getränkebestellung' andType: 'text/html'.! !!DrinklistMailclient methodsFor: 'as yet unclassified' stamp: 'jb 10/26/2017 12:08'!sendRemainderTo: anEmailAddress named: aName forAmount: aMoneyAmount"sends a reminder"| text |text := 'Hallo ', aName, 'Du hast Rekordschulden beim Getränkekühlschrank.Betrag: ', aMoneyAmount asString, 'Bitte denke mal wieder daran zu bezahlen.Viele GrüßeDein Kühlschrank'.self sendEmailTo: anEmailAddress withText:  text withSubject: 'Schulden beim Getränkekühlschrank'.! !!DrinklistMailclient methodsFor: 'as yet unclassified' stamp: 'jb 10/26/2017 16:07'!testIt| liste |liste := {'Orangensaft'->10 . 'Cola'->2}.DrinklistMailclient new sendOrderMailTo: 'jakob.braun@posteo.de' withStock: liste.! !